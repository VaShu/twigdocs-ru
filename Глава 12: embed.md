Тег ```embed``` совмещает в себе возможности тегов ```include``` и ```extends```. Тег позволяет вам включить содержимое другого шаблона так же, как это позволяет делать тег ```include```. Но в то же время он позволяет перезаписать любой блок, определенный внутри подключаемого шаблона, как это позволяет сделать тег ```extends```.

Думайте о встраиваемых шаблонах, как о небольших каркасах вашей страницы:

```twig
{% embed 'teaser_skeleton.twig' %}
  {# эти блоки определены в шаблоне teaser_skeleton.twig #}
  {# мы перезаписываем их прямо тут: #}
  {% block left_teaser %}
    Какое-то содержимое для левого блока тизера
  {% endblock %}
  {% block right_teaser %}
    Какое-то содержимое для правого блока тизера
  {% endblock %}
{% endembed %}
```

Тег ```embed``` передаёт идею наследования шаблонов на уровне фрагментов содержимого. В то время как наследование шаблонов даёт возможность создавать каркасы для целых страниц, где основная роль по наполнению и оживлению ложится на дочерние шаблоны, то использование тега ```embed``` замечательно подходит для использования в небольших структурных единицах используемых несколько раз и в различных местах ваших шаблонов.

С первого взгляда могут быть не ясны примеры применения, поэтому давайте рассмотрим на простом примере. Представьте себе базовый шаблон, который используют множество страниц, с определенным в нём блоком под названием ```content```:

```
----page layout-------------
|       --block "content"---
|       |                  |
|       |   место для сод. |
|       |   дочерних       |
|       |   шаблонов       |
----------------------------
```

Некоторые страницы (foo и bar) обладают одинаковой структурой - содержат два горизонтальных блока:

```
----page layout-------------
|       --block "content"---
|       |   -----------    |
|       |   |    1    |    |
|       |   -----------    |
|       |   |    2    |    |
----------------------------
```

В то же время другие две страницы (boom и baz) обладают другой структурой - содержать два вертикальных блока:

```
----page layout---------------
|       --block "content"-----
|       |   -------------    |
|       |   |     |     |    |
|       |   |  1  |  2  |    |
|       |   |     |     |    |
------------------------------
```

Без использования тега ```embed``` у вас есть два варианта спроектировать шаблоны:

- Создать два промежуточных базовых шаблона, которые будут расширять основной базовый шаблон: один шаблон реализует структуру с двумя вертикальными блоками, другой - с двумя горизонтальными блоками.
- Включить разметку непосредственно в промежуточные шаблоны для блоков 1 и 2 вертикального расположения и горизонтального.

У этих двух решений есть ряд минусов:

- Первое решение, действительно, может сработать в нашем упрощенном примере. Однако стоит только представить, что мы добавим боковую панель, которая по структуру будет так же отличаться для разных страниц, как мы будем вынуждены создавать промежуточные базовые шаблоны уже для каждой из комбинаций вертикальных/горизонтальных блоков и различных расположений блоков в боковой панели.
- Второй решение основано на дублировании часто используемого кода, что, в конечном итоге, приводит к неприятным последствиям: любое изменение - это поиск и изменение кода во всех копиях, корректность правок должна проверяться для каждой копии, копии могут рассинхронизироваться при внесении большого количества правок и т.п.

В такой ситуации тег ```embed`` как раз и пригодится. Общая структура документа может храниться в одном отдельном шаблоне, а два других, назовём из "микро"-шаблонами / "микро"-вставками, будут храниться в отдельных вставляемых шаблонах:

Шаблон для ```foo.twig```:

```twig
{% extends 'layout_skeletone.twig' %}

{% block content %}
  {% embed 'vertical_boxes_skeleton.twig' %}
  {% block top %}
    Содержимое верхнего блока
  {% endblock %}
  
  {% block bottom %}
    Содержимое нижнего блока
  {% endblock %}
{% endblock %}
```

А вот код для ```vertical_boxes_skeleton.twig```:

```twig
<div class="top_box">
  {% block top %}
    Содержимое верхнего блока по-умолчанию
  {% endblock %}
</div>

<div class="bottom_box">
  {% block bottom %}
    Содержимое нижнего блока по-умолчанию
  {% endblock %}
</div>
```

Основное предназначение ```vertical_boxes_skeleton.twig``` хранить всю разметку по блокам в отдельном шаблоне.

Тег ```embed``` может принимать точно такие же аргументы, какие принимает тег ```include```:

```twig
{% embed 'base' with {'foo': 'bar'} %}
...
{% endembed %}

{% embed 'base' with {'foo': 'bar'} only %}
...
{% endembed %}

{% embed 'base' ignore missing %}
...
{% endembed %}
```

В связи с тем, что у встраиваемых шаблонов нет имён, к ним не применимо автоматическое экранирование по именам и оно сработает не так, как вы того ожидаете. Рекомендует явно использовать тег ```autoescape``` и указывать стратегию экранирования.
