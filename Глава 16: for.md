Тег ```for``` используется для итерации (перебора всех объектов коллекции). Например, для отображения списка всех пользователей в переменной ```users```:

```twig
<h1>Members</h1>
<ul>
  {% for user in users %}
    <li>{{ user.username|e }}</li>
  {% endfor %}
</ul>
```

Последовательность может быть как массивом, так и объектом реализующим ```Traversable``` интерфейс.

Для того, чтобы перебрать последовательность чисел можно воспользоваться оператором ```..```:

```twig
{% for i in 0..10 %}
  * {{ i }}
{% endfor }
```

Приведенный выше пример выведет числа от 0 до 10 (включительно).

Такой же подход возможен и с использованием букв:

```twig
{% for с in 'a'..'z' %}
  * {{ с }}
{% endfor %}
```

Оператор ```..``` может принимать любое выражение как с левой стороны, так и с правой:

```twig
{% for с in 'a'|upper..'z'|upper %}
  * {{ c }}
{% endfor %}
```

###### Переменная ```loop```

Внутри цикла ```for``` можно получить доступ к специальным переменным:

- ```loop.index```: текущий номер итерации цикла (начало с 1)
- ```loop.index0```: текущий номер итерации цикла (начало с 0)
- ```loop.revindex```: количество итераций цикла с конца (по индексу 1)
- ```loop.revindex0```: количество итераций цикла с конца (по индексу 0)
- ```loop.first```: ```true``` если итерация первая, ```false``` в противном случае.
- ```loop.last```: ```true``` если итерация последняя, ```false``` в противном случае.
- ```loop.length```: количество объектов в последовательности.
- ```loop.parent```: родительский контекст.

```twig
{% for user in users %}
  {{ loop.index }} - {{ user.username }}
{% endfor %}
```

Переменные ```loop.length```, ```loop.revindex```, ```loop.revindex0``` и ```loop.last``` доступны только при итерации по PHP-массивам или объектам реализующим ```Countable``` интерфейс. Так же перечисленные переменные не доступны при итерациях с условием.

###### Добавление условие

В отличие от PHP в Twig ```for```-цикле нет возможности воспользоваться ```break``` или ```continue```. Перед или во время итерацией можно отфильтровать последовательность. В следующем примере мы пропускаем всех пользователей, которые не являются активными:

```twig
<ul>
  {% for user in users if user.active %}
    <li>{{ user.username|e }}</li>
  {% endfor %}
</ul>
```

Преимущество такого подхода в том, что большинство специальных переменных цикла будут корректно подсчитываться, за исключением тех, которые мы перечислили выше (например, ```loop.last```).

Использование переменной ```loop``` в условии цикла не рекомендуется, т.к. чаще всего оно будет работать не так, как вы того ожидаете. Например, добавление условия ```loop.index > 4``` не будет работать, т.к. увеличение индекса происходит только в том случае, когда условие является истинным.

###### ```else```-ветка

Если в ходе итераций не было произведено ни одного цикла, то вы можете отобразить альтернативный блок (список оказался пустым):

```twig
{% for user in users %}
  * {{ loop.index }} - {{ user.username|e }}
{% else %}
  Пользователей нет.
{% endfor }
```

###### Итерация по ключам

По-умолчанию итерация происходит по значениям последовательности. Если необходимо произвести итерацию по ключам, то для этого есть фильтр ```keys```:

```twig
{% for key in users|keys %}
  * {{ loop.index }} - {{ key }}
{% endfor %}
```

###### Итерация по ключам и значениям

Для одновременной итерации по ключам и значениям:

```twig
{% for key, user in users %}
  * {{ key }} - {{ user.id }}
{% endfor %}
```

###### Итерации по подмножеству значений списка

Возможно возникнет необходимость итерации по части списка, вот как этого можно добиться:

```twig
{% for user in users|slice(0, 10) %}
  {{ user.username|e }}
{% endfor %}
```
